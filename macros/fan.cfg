[gcode_macro M106]
description: Custom wrapper to enable mapping chamber filtration fan from slice
rename_existing: M106.1
gcode:
  {%- set fan = params.P | default(0) | int -%}
  {%- if fan == 3 -%}
    SET_FAN_SPEED FAN=filter_fan SPEED={params.S|default(255)}
  {%- else -%}
    M106.1 {rawparams}
  {%- endif -%}

[gcode_macro M107]
description: Custom wrapper to disable chamber filtration fan on all fan stop
rename_existing: M107.1
gcode:
  SET_FAN_SPEED FAN=filter_fan SPEED=0
  M107.1 {rawparams}